[package]
name = "provisioner-core"
# 版本和 edition 会自动从 workspace 继承
version.workspace = true
edition.workspace = true

[dependencies]
# 核心依赖 (始终需要)
tokio = { workspace = true, features = ["full"] }
axum.workspace = true
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true, optional = true }
thiserror.workspace = true
tracing.workspace = true
async-trait.workspace = true
leasehund.workspace = true # DHCP

# === 可选依赖 (由 Features 控制) ===
zbus = { workspace = true, optional = true }          # D-Bus

# --- 交付方式依赖 ---
rust-embed = { workspace = true, optional = true }
tower-http = { workspace = true, optional = true } # for DiskFrontend
mime_guess = { workspace = true, optional = true }


[features]
# 默认特性为空
default = []

# === 1. 后端实现选择 (隐式决定交付方式) ===
backend_wpa_dbus = ["dep:zbus", "dep:rust-embed", "dep:mime_guess", "dep:serde_json"] # Real backend -> embed
backend_systemd = ["dep:rust-embed", "dep:mime_guess", "dep:serde_json"]             # Real backend -> embed
backend_mock = ["dep:tower-http", "dep:mime_guess", "dep:serde_json"]                # Mock backend -> disk

# === 2. UI 主题选择 ===
ui_bootstrap = []
ui_simple = []